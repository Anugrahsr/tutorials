



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.1, mkdocs-material-2.0.4">
    
    
      
        <title>Whole-genome de-novo Assembly - SGBC Bioinformatics Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-709eec9410.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      <script src="../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="pink" data-md-color-accent="pink">
    
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="SGBC Bioinformatics Tutorials" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Whole-genome de-novo Assembly
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    SGBC Bioinformatics Tutorials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../annotation/" title="Genome Annotation" class="md-nav__link">
      Genome Annotation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Whole-genome de-novo Assembly
      </label>
    
    <a href="./" title="Whole-genome de-novo Assembly" class="md-nav__link md-nav__link--active">
      Whole-genome de-novo Assembly
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-the-data" title="Getting the data" class="md-nav__link">
    Getting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-control" title="Quality control" class="md-nav__link">
    Quality control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de-novo-assembly" title="De-novo assembly" class="md-nav__link">
    De-novo assembly
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparing-assemblies" title="Comparing assemblies" class="md-nav__link">
    Comparing assemblies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-misassemblies" title="Fixing misassemblies" class="md-nav__link">
    Fixing misassemblies
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../file_formats/" title="File formats" class="md-nav__link">
      File formats
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../meta_assembly/" title="Meta assembly" class="md-nav__link">
      Meta assembly
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../metabarcoding/" title="Metabarcoding" class="md-nav__link">
      Metabarcoding
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../pan_genome/" title="Pan genome" class="md-nav__link">
      Pan genome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../qc/" title="Qc" class="md-nav__link">
      Qc
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rna_seq/" title="Rna seq" class="md-nav__link">
      Rna seq
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../unix/" title="Unix" class="md-nav__link">
      Unix
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../variant_calling/" title="Variant calling" class="md-nav__link">
      Variant calling
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../wms/" title="Wms" class="md-nav__link">
      Wms
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-the-data" title="Getting the data" class="md-nav__link">
    Getting the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-control" title="Quality control" class="md-nav__link">
    Quality control
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#de-novo-assembly" title="De-novo assembly" class="md-nav__link">
    De-novo assembly
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparing-assemblies" title="Comparing assemblies" class="md-nav__link">
    Comparing assemblies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-misassemblies" title="Fixing misassemblies" class="md-nav__link">
    Fixing misassemblies
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="whole-genome-de-novo-assembly">Whole-genome de-novo Assembly</h1>
<p>In this practical we will perform the assembly of M. genitalium, a bacterium published in 1995 by Fraser et al in Science.</p>
<h2 id="getting-the-data">Getting the data</h2>
<p>Go to ENA, and search for the run ERR486840.</p>
<p>Download the 2 fastq files associated with the run.</p>
<h2 id="quality-control">Quality control</h2>
<p>Perform quality control of the data as you did in the <a href="../qc/">QC tutorial</a></p>
<p>How many reads are in the fastq file? What is the read length?
Does the data need trimming or other filtering? If so, do it.</p>
<p>Find the genome size of M. genitalium in the Fraser paper abstract.
Based on the expected genome size, the read length and the number of reads – what average coverage do you expect to get from this fastq read files?</p>
<h2 id="de-novo-assembly">De-novo assembly</h2>
<p>We will be using the SPAdes assembler to assemble our bacterium.</p>
<pre><code>module load spades
spades.py -k 21,33,55,77,99 --careful --only-assembler -1 read_1.fastq -2 read_2.fastq -o output
</code></pre>

<p>This will produce a series of outputs. The scaffolds will be in fasta format.</p>
<p>How well does the assembly total consensus size and coverage correspond to your earlier estimation?
What is the N50 of the assembly? What does this mean?
How many contigs in total did the assembly produce?
How many contigs longer than 500bp? What is the N50 of those contigs only?</p>
<p>Perform another assembly with the following options:</p>
<p>Use the raw reads (no trimming, but with adapters removed), wthout the --only-assembler option.</p>
<p>If you have time, try out the following genome assemblers:</p>
<ul>
<li>MaSurCa</li>
<li>Ray</li>
<li>Velvet</li>
</ul>
<h2 id="comparing-assemblies">Comparing assemblies</h2>
<p>QUAST is a software evaluating the quality of genome assemblies by computing various metrics, including</p>
<ul>
<li>N50, length for which the collection of all contigs of that length or longer covers at least 50% of assembly length</li>
<li>NG50, where length of the reference genome is being covered</li>
<li>NA50 and NGA50, where aligned blocks instead of contigs are taken</li>
<li>misassemblies, misassembled and unaligned contigs or contigs bases</li>
<li>genes and operons covered</li>
</ul>
<p>To run Quast:</p>
<pre><code>module load quast
quast.py assembly1.fasta assembly2.fasta ... -R reference.fasta -G reference.gff
</code></pre>

<p>Quast will produce a pdf in the <code>quast_results</code> directory. Download it on your computer and take a look. Which assembly is better?</p>
<h2 id="fixing-misassemblies">Fixing misassemblies</h2>
<p>Pilon is a software tool which can be used to automatically improve draft assemblies. It attempts to make improvements to the input genome, including:</p>
<ul>
<li>Single base differences</li>
<li>Small Indels</li>
<li>Larger Indels or block substitution events</li>
<li>Gap filling</li>
<li>Identification of local misassemblies, including optional opening of new gaps</li>
</ul>
<p>Pilon then outputs a FASTA file containing an improved representation of the genome from the read data and an optional VCF file detailing variation seen between the read data and the input genome.</p>
<p>You can read how Pilon works in detail <a href="https://github.com/broadinstitute/pilon/wiki/Methods-of-Operation">here</a></p>
<p>Before running Pilon itself, you have to map your reads back to the assembly!</p>
<pre><code>bowtie2-build assembly.fasta index_prefix
(bowtie2 -x index_prefix -1 read_1.fastq -2 read_2.fastq | samtools view -bS -o output_to_sort.bam - ) 2&gt; bowtie.err
samtools sort output_to_sort.bam alignment.bam
samtools index alignment.bam
</code></pre>

<p>Run Pilon with the following command:</p>
<pre><code>module load pilon
pilon --genome assembly.fasta --frags alignment.bam --output pilon_output
</code></pre>

<p>Once Pilon is finished running, compare the new assembly with the old one using Quast!</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../annotation/" title="Genome Annotation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Genome Annotation
              </span>
            </div>
          </a>
        
        
          <a href="../file_formats/" title="File formats" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                File formats
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-8e4952e681.js"></script>
      
      <script>app.initialize({version:"0.17.1",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>